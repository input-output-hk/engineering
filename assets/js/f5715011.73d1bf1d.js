"use strict";(globalThis.webpackChunkengineering_iog_io=globalThis.webpackChunkengineering_iog_io||[]).push([[8261],{4094:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>g});var a=t(8168),i=(t(6540),t(5680));const r={slug:"2024-03-21-ghc-update",title:"IOG GHC Update #26",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},l=void 0,o={permalink:"/2024-03-21-ghc-update",editUrl:"https://github.com/input-output-hk/engineering/tree/master/blog/2024-03-21-ghc-update-26.md",source:"@site/blog/2024-03-21-ghc-update-26.md",title:"IOG GHC Update #26",description:"Triweekly update from the GHC DevX team at IOG.",date:"2024-03-21T00:00:00.000Z",formattedDate:"March 21, 2024",tags:[{label:"ghc",permalink:"/tags/ghc"},{label:"ghc-update",permalink:"/tags/ghc-update"}],readingTime:3.295,hasTruncateMarker:!0,authors:[{name:"Sylvain Henry",title:"Haskell DevX Engineer @ IOG",email:"sylvain.henry@iohk.io",key:"sylvain"},{name:"Jeffrey M. Young",title:"Haskell DevX Engineer @ IOG",url:"https://iog.io/en/",key:"doyougnu"},{name:"Luite Stegeman",title:"Haskell DevX Engineer @ IOG",email:"luite.stegeman@iohk.io",key:"luite"}],frontMatter:{slug:"2024-03-21-ghc-update",title:"IOG GHC Update #26",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},prevItem:{title:"IOG GHC Update #27",permalink:"/2024-04-11-ghc-update"},nextItem:{title:"IOG GHC Update #25",permalink:"/2024-02-29-ghc-update"}},s={authorsImageUrls:[void 0,void 0,void 0]},g=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Details",id:"details",level:2},{value:"IOG internal Haskell Tooling survey 2024",id:"iog-internal-haskell-tooling-survey-2024",level:2}],u={toc:g},p="wrapper";function c({components:e,...n}){return(0,i.yg)(p,(0,a.A)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"Triweekly update from the GHC DevX team at IOG."),(0,i.yg)("p",null,"Previous updates can be found ",(0,i.yg)("a",{parentName:"p",href:"https://engineering.iog.io/tags/ghc-update"},"here"),"."),(0,i.yg)("h2",{id:"high-level-summary"},"High level summary"),(0,i.yg)("p",null,"The team contributed to fixing issues blocking the GHC 9.10 alpha 1 release."),(0,i.yg)("p",null,"We continued investigating ",(0,i.yg)("inlineCode",{parentName:"p"},"cardano-node")," performance and found that the lack of specialization\nof polymorphic functions is causing a large amount of allocations. Manually removing the polymorphism\ncaused the amount of allocations to drop by 50% in one instance."),(0,i.yg)("p",null,"We summarized the results of the IOG internal Haskel Tooling survey we conducted in January 2024.\nA summary of the results can be found in the last section of this blog post. According to the results,\nwe should continue to work on improving compiler performance, documentation, and profiling tools. We should also\nbegin to work on improving HLS stability and performance."),(0,i.yg)("h2",{id:"details"},"Details"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},'Jeff/Sylvain: investigated and fixed an issue with the "Non-punning list and\ntuple syntax" patch\n(',(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12130"},"GHC!12130"),",\n",(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/8820"},"GHC!8820"),"),\ndelaying GHC 9.10 alpha release.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Sylvain: summarized results of IOG internal Haskell Tooling survey conducted in January 2024 (summary below).")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Sylvain: reviewed ",(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12179"},"GHC!12179"),". Opened ",(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/issues/24566"},"GHC#24566")," as a follow-up issue and fixed it in ",(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12268"},"GHC!12268"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Sylvain/Josh: made some JS numeric primitives faster by aoviding the use of BigInt ",(0,i.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12125"},"GHC!12125"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Luite: Worked on experimental GHC tooling to investigate a performance regression in ",(0,i.yg)("inlineCode",{parentName:"p"},"cardano-node"),". Some new things tried were: Profiling by sampling STG call stacks (using ",(0,i.yg)("inlineCode",{parentName:"p"},"libdw")," to resolve symbol names), call-site ticky counters for dictionary passing, building a dynamic call graph by recording all calls in the whole program. So far, this has led the the identification of a specific issue where GHC failed to specialize, resulting in an excessive amount of allocation.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Jeff: started characterizing preformance of Haskell codes with and without the tables-next-to-code optimization"))),(0,i.yg)("h2",{id:"iog-internal-haskell-tooling-survey-2024"},"IOG internal Haskell Tooling survey 2024"),(0,i.yg)("p",null,"The Haskell Tooling Survey 2024 revealed insights into users' experiences, challenges, and desires for improvement across various tools in the Haskell ecosystem:"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"GHC:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users expressed concerns about slow compilation times, especially on low-power devices, and desires for a lightweight toolchain with a small runtime and quick installation process. Some also highlighted worries about the declining popularity of Haskell and its potential impact on the language's future.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Cabal:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users reported frustrations with Cabal, including issues with rebuilding dependencies unnecessarily, confusing solver errors, and its aging build system. Desired improvements included simplifying the Cabal build process, better documentation, and integration with other languages.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Haskell Language Server (HLS):")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"HLS users faced daily annoyances such as slow performance, crashes, and flakiness. Desired improvements included better integration with GHC, addressing polyrepo structure issues, and fixing specific template Haskell-related problems.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"haskell.nix:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users desired improvements to haskell.nix, including cleaning up documentation, providing more canonical examples, and addressing issues like unnecessary recompilation of libraries.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"IDEs and Editors:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users expressed a need for better IDE support, with desires for faster and more robust IDEs comparable to modern IDEs like IntelliJ. They also highlighted challenges in setting up tools like HLS with Nix and VSCodium.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Documentation and Learning Material:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Suggestions included the creation of a completed Haskell optimization handbook, improvement of Cabal documentation, and more comprehensive resources for onboarding new developers.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"GHC's WebAssembly/JavaScript Backends:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Interest in using GHC's WebAssembly/JavaScript backends varied, with some expressing likelihood of use for GUIs and mobile devices, while others cited limitations in library compatibility as barriers to adoption.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Debugging and Analyzing Tools:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Responses varied regarding satisfaction with debugging and analyzing tools, with some users desiring a more integrated experience and others finding the existing tools adequate.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Future Concerns:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users expressed worries about the declining popularity of Haskell, undisciplined use of language extensions, potential company bankruptcies affecting support for GHC, competition from other languages, and lack of full-time maintenance resources.")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Desired Changes:")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Users desired improvements such as a lightweight toolchain, better support for ambiguous record fields, increased full-time tooling contributors, improved cross-platform build process, and a focus on regaining Haskell's status as a language of innovation.")))}c.isMDXComponent=!0},5680:(e,n,t)=>{t.d(n,{xA:()=>u,yg:()=>m});var a=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),g=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=g(e.components);return a.createElement(s.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef(function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=g(t),d=i,m=p["".concat(s,".").concat(d)]||p[d]||c[d]||r;return t?a.createElement(m,l(l({ref:n},u),{},{components:t})):a.createElement(m,l({ref:n},u))});function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,l=new Array(r);l[0]=d;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o[p]="string"==typeof e?e:i,l[1]=o;for(var g=2;g<r;g++)l[g]=t[g];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);