"use strict";(globalThis.webpackChunkengineering_iog_io=globalThis.webpackChunkengineering_iog_io||[]).push([[9761],{1670:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>g,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=r(8168),n=(r(6540),r(5680));const i={slug:"2024-02-29-ghc-update",title:"IOG GHC Update #25",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},o=void 0,l={permalink:"/2024-02-29-ghc-update",editUrl:"https://github.com/input-output-hk/engineering/tree/master/blog/2024-02-29-ghc-update-25.md",source:"@site/blog/2024-02-29-ghc-update-25.md",title:"IOG GHC Update #25",description:"Triweekly update from the GHC DevX team at IOG.",date:"2024-02-29T00:00:00.000Z",formattedDate:"February 29, 2024",tags:[{label:"ghc",permalink:"/tags/ghc"},{label:"ghc-update",permalink:"/tags/ghc-update"}],readingTime:1.635,hasTruncateMarker:!0,authors:[{name:"Sylvain Henry",title:"Haskell DevX Engineer @ IOG",email:"sylvain.henry@iohk.io",key:"sylvain"},{name:"Jeffrey M. Young",title:"Haskell DevX Engineer @ IOG",url:"https://iog.io/en/",key:"doyougnu"},{name:"Luite Stegeman",title:"Haskell DevX Engineer @ IOG",email:"luite.stegeman@iohk.io",key:"luite"}],frontMatter:{slug:"2024-02-29-ghc-update",title:"IOG GHC Update #25",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},prevItem:{title:"IOG GHC Update #26",permalink:"/2024-03-21-ghc-update"},nextItem:{title:"IOG GHC Update #24",permalink:"/2024-02-08-ghc-update"}},g={authorsImageUrls:[void 0,void 0,void 0]},s=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Details",id:"details",level:2}],p={toc:s},u="wrapper";function c({components:e,...t}){return(0,n.yg)(u,(0,a.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"Triweekly update from the GHC DevX team at IOG."),(0,n.yg)("p",null,"Previous updates can be found ",(0,n.yg)("a",{parentName:"p",href:"https://engineering.iog.io/tags/ghc-update"},"here"),"."),(0,n.yg)("h2",{id:"high-level-summary"},"High level summary"),(0,n.yg)("p",null,"The team continued working on characterizing a ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/IntersectMBO/ouroboros-consensus/issues/465"},"performance regression in ouroboros-consensus")," when upgrading GHC from 8.10.7 to 9.6.\nAs GHC isn't backward compatible, upgrading GHC not only means upgrading the compiler but also upgrading dependencies (including boot libraries),\nmaking investigations difficult because changes aren't isolated.\nWe've enhanced GHC profiling tools (not upstreamed yet) to give the ability to applications (cardano-node here) to profile\nonly a code section where we know a regression occurred. Investigation is still in progress."),(0,n.yg)("p",null,"Patches mentioned in ",(0,n.yg)("a",{parentName:"p",href:"https://engineering.iog.io/2024-02-08-ghc-update"},"our last update")," for inclusion in GHC 9.10 have been completed and merged:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"pure Haskell implementation of bytestring (",(0,n.yg)("a",{parentName:"li",href:"https://github.com/haskell/bytestring/pull/631"},"bytestring#631"),")"),(0,n.yg)("li",{parentName:"ul"},"support for C sources (e.g. sqlite) with the JS backend (",(0,n.yg)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11502"},"GHC!11502"),")"),(0,n.yg)("li",{parentName:"ul"},"JSTG optimizer (",(0,n.yg)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11507"},"GHC!11507"),") ")),(0,n.yg)("p",null,"We've started summarizing the results of our IOG-internal survey about Haskell tooling."),(0,n.yg)("h2",{id:"details"},"Details"),(0,n.yg)("p",null,"Luite: Has been investigating a ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/IntersectMBO/cardano-node"},"cardano-node")," performance regression caused by upgrading from GHC 8.10 to GHC 9.6. Much of the work was related to improving ways we can measure performance of Haskell programs compiled with GHC. We hope we can merge some of the improvements into GHC in the future."),(0,n.yg)("p",null,"Luite: JSTG optimizer has been merged after some small improvements and fixes: ",(0,n.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11507"},"GHC!11507"),"."),(0,n.yg)("p",null,"Sylvain: reviewed a patch submitted by an external contributor to fix ",(0,n.yg)("inlineCode",{parentName:"p"},"ghcjs-dom")," package for the JS backend: ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/ghcjs/ghcjs-dom/pull/104"},"ghcjs-dom!104"),"\nIt's nice seeing the GHCJS libraries starting to be upgraded to use the JS backend!"),(0,n.yg)("p",null,"Josh/Sylvain: improved the performance of some JS numeric primitives: ",(0,n.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12125"},"GHC!12152")),(0,n.yg)("p",null,"Sylvain: started summarizing the results of our IOG-internal survey about Haskell tooling."),(0,n.yg)("p",null,"Sylvain: made bitcast between words and floats real primops with constant-folding for better performance and code optimization: ",(0,n.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11973"},"GHC!11973")),(0,n.yg)("p",null,"Josh: use STG tag inference to determine if a binder is evaluated in the JS backend: ",(0,n.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11857"},"GHC!11857")),(0,n.yg)("p",null,"Jeff: removed redundant ",(0,n.yg)("inlineCode",{parentName:"p"},"GHC.Cmm.DataFlow.Collections")," module: ",(0,n.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12120"},"GHC!12120")),(0,n.yg)("p",null,"Jeff: did some merge request review; all merged now:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11962"},"GHC!11962")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/11679"},"GHC!11679")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12126"},"GHC!12126"))))}c.isMDXComponent=!0},5680:(e,t,r)=>{r.d(t,{xA:()=>p,yg:()=>h});var a=r(6540);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var g=a.createContext({}),s=function(e){var t=a.useContext(g),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=s(e.components);return a.createElement(g.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef(function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,g=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(r),m=n,h=u["".concat(g,".").concat(m)]||u[m]||c[m]||i;return r?a.createElement(h,o(o({ref:t},p),{},{components:r})):a.createElement(h,o({ref:t},p))});function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=m;var l={};for(var g in t)hasOwnProperty.call(t,g)&&(l[g]=t[g]);l.originalType=e,l[u]="string"==typeof e?e:n,o[1]=l;for(var s=2;s<i;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"}}]);