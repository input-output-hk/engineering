"use strict";(self.webpackChunkengineering_iog_io=self.webpackChunkengineering_iog_io||[]).push([[4110],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return u}});var i=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=i.createContext({}),c=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=c(e.components);return i.createElement(l.Provider,{value:n},e.children)},h={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},p=i.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(t),u=o,m=p["".concat(l,".").concat(u)]||p[u]||h[u]||a;return t?i.createElement(m,r(r({ref:n},d),{},{components:t})):i.createElement(m,r({ref:n},d))}));function u(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,r=new Array(a);r[0]=p;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var c=2;c<a;c++)r[c]=t[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}p.displayName="MDXCreateElement"},2607:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},assets:function(){return d},toc:function(){return h},default:function(){return u}});var i=t(7462),o=t(3366),a=(t(7294),t(3905)),r=["components"],s={slug:"2023-06-28-p2p",title:"Unveiling Cardano's Dynamic P2P: a leap forward in decentralization",authors:["bolt12"],tags:["networking","p2p"],custom_edit_url:null},l=void 0,c={permalink:"/2023-06-28-p2p",editUrl:"https://github.com/input-output-hk/engineering/tree/master/blog/2023-06-28-dynamic-p2p.md",source:"@site/blog/2023-06-28-dynamic-p2p.md",title:"Unveiling Cardano's Dynamic P2P: a leap forward in decentralization",description:"Banner",date:"2023-06-28T00:00:00.000Z",formattedDate:"June 28, 2023",tags:[{label:"networking",permalink:"/tags/networking"},{label:"p2p",permalink:"/tags/p-2-p"}],readingTime:15.33,truncated:!0,authors:[{name:"Armando Santos",title:"Networking Team Engineer",email:"armando.santos@iohk.io",key:"bolt12"}],frontMatter:{slug:"2023-06-28-p2p",title:"Unveiling Cardano's Dynamic P2P: a leap forward in decentralization",authors:["bolt12"],tags:["networking","p2p"],custom_edit_url:null},prevItem:{title:"IOG GHC Update #13",permalink:"/2023-06-29-ghc-update"},nextItem:{title:"IOG GHC Update #12",permalink:"/2023-06-15-ghc-update"}},d={authorsImageUrls:[void 0]},h=[{value:"Introduction",id:"introduction",children:[],level:2},{value:"What is Dynamic P2P",id:"what-is-dynamic-p2p",children:[],level:2},{value:"The design vision",id:"the-design-vision",children:[],level:2},{value:"Analyzing peer selection for block relays in Ouroboros",id:"analyzing-peer-selection-for-block-relays-in-ouroboros",children:[{value:"Problem statement",id:"problem-statement",children:[],level:3},{value:"Preliminary research",id:"preliminary-research",children:[],level:3}],level:2},{value:"P2P networking based on local information",id:"p2p-networking-based-on-local-information",children:[{value:"Churning and local policies",id:"churning-and-local-policies",children:[],level:3}],level:2},{value:"Development approach",id:"development-approach",children:[],level:2}],p={toc:h};function u(e){var n=e.components,s=(0,o.Z)(e,r);return(0,a.kt)("wrapper",(0,i.Z)({},p,s,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Banner",src:t(2204).Z,width:"1601",height:"901"})),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"As the Cardano ecosystem continues to grow and evolve, contributors to the Cardano\necosystem are committed to continually refining and optimizing Cardano's networking\ninfrastructure. The release of Dynamic peer-to-peer (P2P) networking, delivered with node\nv.1.35.6, was a collaborative effort of the networking team from ",(0,a.kt)("a",{parentName:"p",href:"https://iog.io/"},"IOG"),", ",(0,a.kt)("a",{parentName:"p",href:"https://www.well-typed.com/"},"Well-Typed"),",\n",(0,a.kt)("a",{parentName:"p",href:"http://www.pnsol.com/"},"PNSol")," and the ",(0,a.kt)("a",{parentName:"p",href:"https://cardanofoundation.org/"},"Cardano Foundation")," and represents a highly performant deliverable and a\nsignificant milestone in Cardano's journey toward establishing a fully decentralized and\nsecure blockchain platform."),(0,a.kt)("p",null,"Given that Cardano functions as a real-time stochastic system, its performance and\nsecurity are inherently interconnected. The networking team remains committed to finding\nthe ideal balance among various factors, including topological and topographic\nconsiderations, to enhance timeliness and connectivity."),(0,a.kt)("p",null,"This blog post takes you through the engineering journey behind the development of\nCardano's Dynamic P2P design. It delves into the core design principles, highlights the\nchallenges encountered along the way, and unveils the solutions the team devised to\nestablish a robust and scalable networking system."),(0,a.kt)("h2",{id:"what-is-dynamic-p2p"},"What is Dynamic P2P"),(0,a.kt)("p",null,"The Dynamic P2P implementation continuously and dynamically refines the active topology\nthrough a peer selection process, with the objective of reducing the overall diffusion\ntime across the entire network. Research findings suggest that utilizing a policy based\nsolely on local information can result in an almost-optimal global outcome. This is\nachieved by monitoring the timeliness and frequency of peers that provide a block header,\nwhich is ultimately incorporated into the chain."),(0,a.kt)("p",null,"The primary goal is to eliminate highly \u2018non-optimal\u2019 peers while maintaining strong\nconnectivity. To achieve this, peers considered less useful based on this metric are\nperiodically \u2018churned out\u2019 and replaced with randomly selected alternatives. Simulation\nresults indicate that this optimization method converges towards a near-optimal global\noutcome within a relatively small number of iterations."),(0,a.kt)("p",null,"Practically, Dynamic P2P replaces the manual configuration of peer selection (e.g. using the\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/cardano-community/guild-operators/blob/alpha/docs/Scripts/topologyupdater.md"},"topology updater tool"),")."),(0,a.kt)("p",null,"With manual configuration, stake pool operators (SPOs) were required to establish\nconnections with a significant number of peers (50 for example) to maintain a minimum of\n20 active connections consistently. This approach was necessary due to the static nature\nof configured peers and the varying availability of SPO relays."),(0,a.kt)("p",null,"However, with Dynamic P2P, nodes can be configured to maintain a specific number of active\npeer connections (e.g. 20) and select from all registered SPO relays on the chain. In the\nevent of a lost connection with a peer, the node will automatically select alternative\npeers and persistently attempt connections until the desired target is reached."),(0,a.kt)("p",null,"As a result, Dynamic P2P eliminates the requirement for over-provisioning of connections,\noffering a more efficient and adaptable networking solution."),(0,a.kt)("h2",{id:"the-design-vision"},"The design vision"),(0,a.kt)("p",null,"Cardano operates as a cooperative system composed of autonomous nodes. It is not designed\nas a client-server model, meaning there is no central point of control or privileged class\nof centrally managed servers. While the network topology may have initially started as\nfederated during the Byron development phase, the objective was to evolve it into a fully\ntrustless distributed networking system capable of meeting the evolving demands of the\nCardano ecosystem \u2013 all while ensuring optimal connectivity and performance."),(0,a.kt)("p",null,"As the networking team embarked on this engineering adventure, they were well aware that\nthey would encounter numerous challenges and complexities along the way. However, they\nfaced these challenges head-on, continuously refining the core ideas that would ultimately\nshape the design of the Dynamic P2P system:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Modularity and Extensibility"),": the system was designed with modularity in mind,\nmaking it easy to swap out or improve individual components as needed. This\nextensibility allows for seamless integration of new features and enhancements,\nensuring that the design remains adaptive to the evolving needs of the Cardano\necosystem. Modularity is especially helpful when formal methods are applied to prove\nthe correctness of low-level designs in relation to high-level specifications. By\nbreaking down the system into smaller, more manageable components, it becomes possible\nto apply property-based testing to each module more effectively, ensuring that each\npart\u2019s behavior is well-defined and adheres to the expected properties. Of course, the\nchoice of functional programming with Haskell as the primary programming language\nplayed a significant role in achieving this level of modularity and extensibility.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Scalability"),": as the network grows, the demand for a system capable of handling a\nlarger number of nodes and transactions while respecting Ouroboros\u2019 timing constraints\nalso increases. To address this scalability requirement in the P2P design vision, the\nteam considered scalability properties from the very beginning and incorporated\nstrategies such as intelligent peer selection.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Security and Resilience"),": in a decentralized network, resilience and security are of\nparamount importance. The goal was to construct a system capable of withstanding\ninternal and external disruptions. To achieve this, the networking team implemented\nrobust error handling mechanisms designed for resilience against abuse, ensuring that\nusers cannot attack the system through asymmetric denial of service attacks that\ndeplete network resources for other users. With the P2P approach, each node can\nprioritize its connection to locally configured peers. This ensures that the node\nmaintains a connection to trusted peers and can make progress in the network. Inbound\nconnections are rate limited, and configurable peer targets allow the node to adjust\nits resource consumption. Additionally, careful management of connection states enables\nreusing duplex connections, allowing nodes behind firewalls to safely improve their\nconnectivity while reducing the overall attack surface.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Performance"),": a highly-performant network is crucial for ensuring a seamless user\nexperience. Substantial effort was invested into optimizing the design by employing\ntechniques such as efficient data transmission through multiplexing and utilizing\nprotocols that support pipelining. Additionally, intelligent peer selection plays a\nvital role in reducing latency and ensuring a responsive and reliable network."))),(0,a.kt)("p",null,"Establishing effective communication within the Cardano network requires achieving low\nlatency and good connectivity. To fulfill these essential requirements, Dynamic P2P was\ndesigned to ensure a robust, scalable, and resilient foundation for the ecosystem's\ncontinued growth. However, it is important to recognize that peer trustworthiness is a\ncritical factor in maintaining a secure and reliable network. While delving into the\ndetails of trustworthiness is beyond the scope of this blog post, it is worth noting that\nthe P2P design incorporates multiple measures to mitigate potential risks and safeguard\nthe network."),(0,a.kt)("h2",{id:"analyzing-peer-selection-for-block-relays-in-ouroboros"},"Analyzing peer selection for block relays in Ouroboros"),(0,a.kt)("p",null,"Ensuring Ouroboros\u2019 performance and security is crucial, and one critical aspect of this\nis the timely relay of new blocks across the network. Ideally, the connections within the\nP2P network should be organized in a way that minimizes the time required for a block to\nbe relayed from any node to all other nodes in the network."),(0,a.kt)("p",null,"However, achieving this goal presents a complex challenge, with limited prior work\navailable that is applicable in a trustless setting. Effectively addressing this problem\nnecessitated the development of innovative solutions that could strike a balance between\nswift communication and maintaining the integrity and security of the decentralized\nnetwork."),(0,a.kt)("h3",{id:"problem-statement"},"Problem statement"),(0,a.kt)("p",null,"An effective solution for optimizing performance involves minimizing the number of \u2018hops\u2019\na block needs to traverse across the network. In graph terms, this translates to reducing\nthe average number of edges a block traverses. Moreover, the length of each hop or edge is\ncrucial. Local links exhibit lower latency compared to intercontinental links, although\nsome intercontinental links are necessary for global block relay. For example, a\nsuboptimal solution would involve excessive intercontinental links, such as routing from\nEurope to Asia and back."),(0,a.kt)("p",null,"Existing networking algorithms can generate optimal \u2018spanning trees\u2019 that could serve as\npaths for block relay. However, these algorithms rely on nodes trusting each other to\nexchange accurate information, which is unsuitable for a blockchain P2P network where\nnodes cannot inherently trust each other."),(0,a.kt)("p",null,"An ideal solution should rely on \u2018local\u2019 rather than \u2018global\u2019 information \u2013 information\nthat nodes can assess individually without relying on shared and trusted data.\nNevertheless, having an optimal solution that depends on perfect global information can\nserve as a valuable reference point."),(0,a.kt)("h3",{id:"preliminary-research"},"Preliminary research"),(0,a.kt)("p",null,"The IOG networking team collaborated with network researchers from Athens University, who\nspecialize in decentralized systems and their protocols, to undertake a crucial task \u2013\nsimulating different network policies and studying the trade-offs in diffusion time."),(0,a.kt)("p",null,"The pivotal question regarding dissemination is determining which nodes should forward\nblocks to each other, or, more precisely, which dissemination links should be established\namong nodes to improve dissemination speed."),(0,a.kt)("p",null,"In tackling this question, together with the researchers we pursued two primary approaches:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The first approach assumes that links are independent of the dissemination process. It\ninvolves simulating a static overlay where links are established according to predefined\nrules. Multiple disseminations are then executed to measure the performance.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The second approach involves dynamically adjusting the overlay. In this approach, nodes\ninitially establish connections with random nodes in the network and continuously\nmonitor the performance statistics of their neighbors. Periodically, each node adjusts\nits set of neighbors based on these statistics, deciding which neighbors to retain and\nwhich ones to replace."))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Close-Random policy comparison",src:t(2121).Z,width:"1601",height:"901"})),(0,a.kt)("p",null,"The plot demonstrates the rapid dissemination of a block throughout the network, reaching\nall nodes eventually. In this experiment, all nodes use the exact same Close-Random policy\n\u2013 e.g. C6R4 means nodes connect to six close peers and four random peers. Initially, all\nnodes are uninformed, meaning they have not yet received the specific block. However, they\nbecome informed at some point during the experiment. The dotted line represents the\ntheoretical optimal solution, assuming all informed nodes possess complete knowledge of\nwhich peers are most advantageous, enabling such connections (god's view policy)."),(0,a.kt)("p",null,"It is important to clarify that the Close-Random policy was not implemented directly.\nRather, it was employed as a practical theoretical tool. It strikes a balance by\nincorporating non-local factors while remaining simple enough to be approximated using\nonly local information."),(0,a.kt)("p",null,"This analysis demonstrates how close it is possible to get to an ideal solution using\nprimarily local information. What's intriguing is that this approach surpasses\nexpectations. Achieving a result within a factor of two of perfection would have been\ncommendable, but the team discovered that it is possible to surpass even that."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Close-Random policy vs two groups calibration",src:t(8067).Z,width:"1601",height:"901"})),(0,a.kt)("p",null,"The above figure compares the outcomes from the two approaches described earlier. The\nsimulation involved each node maintaining six ",(0,a.kt)("em",{parentName:"p"},"close")," neighbors (based on Round Trip Time\n(RTT)), and four ",(0,a.kt)("em",{parentName:"p"},"random")," nodes. These links were kept static throughout the entire\nexperiment (hence the constant blue lines). In the 'two groups (<=100ms and >100ms)'\npolicy, each node maintains a fixed number of close links and remote links: 'close'\nsignifies that the RTT to that neighbor is less or equal to 100 ms, while \u2018remote\u2019 implies\nthat the RTT is more than 100 ms. Nodes start with all random links and periodically\ncalibrate. During this calibration, they retain up to a fixed number of neighbors that\nhave an RTT of less than 100 ms, and they replace some of the remaining neighbors with\nnewly picked random nodes."),(0,a.kt)("p",null,"This ",(0,a.kt)("em",{parentName:"p"},"two groups")," policy serves as a straightforward, effective approximation for\nevaluating scoring policy behavior. It's worth noting, however, that this policy isn't the\none currently employed."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Close-Random policy vs Peer Score",src:t(2068).Z,width:"1601",height:"901"})),(0,a.kt)("p",null,"A comparative analysis is presented in this final figure, between the outcomes resulting\nfrom the previously discussed Close-Random policy and a different peer scoring policy.\nThis alternative policy evaluates peers based on the frequency with which they supply a\nnew block header to the node before others. In this experimental setup, nodes start with\nrandom links and periodically undergo calibration. During these calibration intervals, the\nbottom-performing 20% or 40% of peers are replaced with new, randomly selected nodes."),(0,a.kt)("p",null,"The blue line in the graph represents the policy that is currently being used (further\ndetails about this can be found in the subsequent section). The green line illustrates the\ntheoretical optimum."),(0,a.kt)("p",null,"Upon close examination of this graph, and drawing comparisons to the previous one, we can\nidentify key variations in the effectiveness of the different scoring policies.\nNonetheless, it's critical to keep in mind that these variations are not directly\ncomparable due to the different parameters applied in each experiment. Some experiments\nmeasure complete dissemination time, while others consider the 99th percentile, which\nrepresents a slightly lower value. Moreover, latency traces between nodes differ across\nexperiments, leading to distinct results."),(0,a.kt)("p",null,"In this context, the 99th percentile for the 20% policy shows a lower equilibrium compared\nto the ",(0,a.kt)("em",{parentName:"p"},"two groups"),". However, this is not a direct 'apples to apples' comparison due to the\nreasons stated above."),(0,a.kt)("p",null,"The policy that we currently employ goes beyond the use of RTT when selecting peers. In\nour quest for a more robust and reliable approach, we sought an alternative that would\naccurately reflect a peer's usefulness. This brought us to the concept of rewarding peers\nfor being the first to present a node with a new header or block. This approach presents\nan authentic measure of a peer's contribution to the network, and unlike RTT, it cannot be\neasily manipulated or faked."),(0,a.kt)("h2",{id:"p2p-networking-based-on-local-information"},"P2P networking based on local information"),(0,a.kt)("p",null,"In the Dynamic P2P design, each node maintains a local view of the network and evaluates\npotential connections considering historical performance. Nodes continuously monitor and\nadjust their connections, seeking better performing peers to optimize their network\nposition and minimize the number of hops required for block relay."),(0,a.kt)("p",null,"Each node maintains three sets of known peer nodes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Cold")," peers: known peers without an established network connection"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Warm")," peers: peers with an established bearer connection, used for network\nmeasurements but not for any application-level consensus protocols, their primary role\nis to serve as a readily available set of nodes"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Hot")," peers: peers with an active bearer connection, utilized for the application-level\nconsensus protocols.")),(0,a.kt)("p",null,"As previously mentioned, nodes maintain limited information about these peers, based on\nprevious direct interactions. For cold nodes, this information may often be absent due to\nthe lack of prior direct interactions. This information resembles \u2018reputation\u2019 in other\nsystems, but it is essential to emphasize that it is purely local and not shared with any\nother node."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Peer discovery on Cardano",src:t(2653).Z,width:"1428",height:"787"})),(0,a.kt)("p",null,"Figure above illustrates the promotion/demotion cycle, managed by the peer selection\ngovernor (PSG). This component is responsible for achieving specific targets, such as\nmaintaining a designated number of known and active peers."),(0,a.kt)("p",null,"Additionally, a local static configuration can be utilized to designate certain nodes as\nhot or warm peers. This approach allows for fixed relationships between nodes managed by a\nsingle organization, such as a stake pool with multiple relays. It also facilitates\nprivate peering arrangements between SPOs and other potential deployment scenarios."),(0,a.kt)("p",null,"In cases of adversarial behavior, a peer can be immediately demoted from the hot, warm,\nand cold sets. The decision is not to retain negative peer information for extended\nperiods to limit resource consumption in a permissionless system, as doing so could\npotentially simplify Sybil attacks."),(0,a.kt)("h3",{id:"churning-and-local-policies"},"Churning and local policies"),(0,a.kt)("p",null,"The peer churn governor (PCG) is a component that plays a pivotal role in managing the\nhealth and efficiency of a network by navigating issues related to network partition and\neclipse attacks, by adjusting the values of the targets for hot, warm, and cold peers so\nas to promote their churning."),(0,a.kt)("p",null,"In this process, the PCG modifies the frequency at which peers are promoted (upgraded from\ncold to warm, or warm to hot) or demoted (downgraded from hot to warm, or warm to cold).\nThis decision is guided by scoring functions that evaluate peers based on their usefulness\nand performance."),(0,a.kt)("p",null,"These scoring functions include:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Hot Demotion Policy"),": responsible for determining which 'hot' (highly active and\nvaluable) peers should be demoted. The score is calculated based on a peer's\ncontribution to the network, considering factors such as the number of blocks it has\nbeen the first to provide and/or the number of bytes it has provided. During normal\noperation, a combination of these factors is used to compute the score. However, during\nbulk sync data synchronization, the number of bytes provided takes precedence.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Warm Demotion Policy and Cold Forget Policy"),": handle 'warm' and 'cold' peers,\ndetermining which peers should be downgraded or removed from the network. These\ndecisions are influenced by a certain level of randomness and various characteristics.\nFactors taken into account include previous failures or a tepidity flag, which indicates\nless reliability or lower activity levels in peers."))),(0,a.kt)("p",null,"During the node syncing process, the PCG ensures that no more than two active connections\nare utilized to prevent resource overutilization. Once the node is fully synced, the PCG\nfacilitates periodic churn, refreshing 20% of the peers every hour. This\npromotes a robust and adaptable network."),(0,a.kt)("p",null,"While the Close-Random or Score-based policies explored in the research are not directly\nreplicated in the production environment, they have significantly influenced the design of\nthe implemented policies. Thus, the research findings have played a crucial role in\nshaping the networking policies within the Cardano production environment."),(0,a.kt)("h2",{id:"development-approach"},"Development approach"),(0,a.kt)("p",null,"Cardano's P2P implementation is built upon Haskell, a functional programming language\nwidely recognized for its correctness, safety, and maintainability. Haskell's robust type\nsystem aids in the detection of potential issues during development, resulting in more\nrobust and reliable code. Additionally, the networking team have developed and now employ\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/io-sim"},(0,a.kt)("inlineCode",{parentName:"a"},"io-sim")),", a time-based discrete event simulation library that offers precise control over\nentropy and timing in simulations. This tool faithfully replicates Haskell's runtime\nsystem, including features such as Software Transactional Memory (STM), ",(0,a.kt)("em",{parentName:"p"},"MVars"),", and more.\nThis level of control allows for reproducibility, regression testing, and examination of\nworst-case scenarios. The combination of Haskell and ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/io-sim"},(0,a.kt)("inlineCode",{parentName:"a"},"io-sim"))," allows rigorous testing of the\nsame code used in the P2P production system under a wide range of conditions, ensuring its\nreadiness to tackle real-world challenges."),(0,a.kt)("p",null,"In the commitment to building a reliable system, the IOG networking team employed extensive\nproperty-based testing. These tests were specifically designed to uncover complex bugs and\ncorner cases that might go unnoticed in traditional testing approaches like unit testing.\nOne distinctive aspect of the testing process is the inclusion of simulations that\nreplicate years of system operation. This comprehensive approach allows mimicking years'\nworth of activity, uncovering rare bugs that may only surface under specific or prolonged\nconditions. However, it is important to note that the quality of these tests ultimately\ndepends on the quality of the generators employed. Generators play a critical role in\nproducing diverse and representative inputs for thorough evaluation."))}u.isMDXComponent=!0},2068:function(e,n,t){n.Z=t.p+"assets/images/20-40-bf85a7b847b22b137cdf2ea5eeac88f6.png"},8067:function(e,n,t){n.Z=t.p+"assets/images/calibrations-9a2490c9e7787830407a54a0cbe900db.png"},2121:function(e,n,t){n.Z=t.p+"assets/images/close-random-graph-1-a48959d8ccb03e8317d49dac848f6ebf.png"},2204:function(e,n,t){n.Z=t.p+"assets/images/p2p-banner-14683a3ff0e7334098173db8e96c2980.png"},2653:function(e,n,t){n.Z=t.p+"assets/images/peer-discovery-b33c92ee26420238da0f9f15b034e5bb.jpg"}}]);