"use strict";(globalThis.webpackChunkengineering_iog_io=globalThis.webpackChunkengineering_iog_io||[]).push([[7209],{5680:(e,t,n)=>{n.d(t,{xA:()=>g,yg:()=>d});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},g=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef(function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),u=p(n),c=r,d=u["".concat(s,".").concat(c)]||u[c]||h[c]||i;return n?a.createElement(d,o(o({ref:t},g),{},{components:n})):a.createElement(d,o({ref:t},g))});function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5791:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(8168),r=(n(6540),n(5680));const i={slug:"2024-07-08-ghc-update",title:"IOG GHC Update #31",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},o=void 0,l={permalink:"/2024-07-08-ghc-update",editUrl:"https://github.com/input-output-hk/engineering/tree/master/blog/2024-07-08-ghc-update-31.md",source:"@site/blog/2024-07-08-ghc-update-31.md",title:"IOG GHC Update #31",description:"Triweekly update from the GHC DevX team at IOG.",date:"2024-07-08T00:00:00.000Z",formattedDate:"July 8, 2024",tags:[{label:"ghc",permalink:"/tags/ghc"},{label:"ghc-update",permalink:"/tags/ghc-update"}],readingTime:1.48,hasTruncateMarker:!0,authors:[{name:"Sylvain Henry",title:"Haskell DevX Engineer @ IOG",email:"sylvain.henry@iohk.io",key:"sylvain"},{name:"Jeffrey M. Young",title:"Haskell DevX Engineer @ IOG",url:"https://iog.io/en/",key:"doyougnu"},{name:"Luite Stegeman",title:"Haskell DevX Engineer @ IOG",email:"luite.stegeman@iohk.io",key:"luite"}],frontMatter:{slug:"2024-07-08-ghc-update",title:"IOG GHC Update #31",authors:["sylvain","doyougnu","luite"],tags:["ghc","ghc-update"]},prevItem:{title:"IOG GHC Update #32",permalink:"/2024-07-24-ghc-update"},nextItem:{title:"IOG GHC Update #30",permalink:"/2024-06-17-ghc-update"}},s={authorsImageUrls:[void 0,void 0,void 0]},p=[{value:"High-level Summary",id:"high-level-summary",level:2},{value:"Details",id:"details",level:2}],g={toc:p},u="wrapper";function h({components:e,...t}){return(0,r.yg)(u,(0,a.A)({},g,t,{components:e,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Triweekly update from the GHC DevX team at IOG."),(0,r.yg)("p",null,"Previous updates can be found ",(0,r.yg)("a",{parentName:"p",href:"https://engineering.iog.io/tags/ghc-update"},"here"),"."),(0,r.yg)("h2",{id:"high-level-summary"},"High-level Summary"),(0,r.yg)("p",null,"This is our sprint after attending Zurihac and an IOG meetup in Zurich. The team\nwas getting back into the groove but was in a holding pattern. Luite was on\nvacation for almost the entire sprint, Sylvain for one week, and Jeff contracted covid (again!) and was\nsimilarly out."),(0,r.yg)("h2",{id:"details"},"Details"),(0,r.yg)("p",null,"Jeff: Began migrating the patches in Haskell.nix to GHC head. In total there are\n271 patches across numerous platforms and GHC versions. However most of these\npatches are duplicates, meaning that the same patch is listed in Haskell.nix for\nsay GHC-9.8 and GHC-9.10. So we do not need to migrate such a patch twice. Jeff\nhas finished opening branches to prepare for MRs on all the easily applied\npatches."),(0,r.yg)("p",null,"Jeff: Fixed a ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/NixOS/nixpkgs/issues/324384"},"bug"),' in the\nGHC-8.10.7 derivation in nixpkgs. If you\'ve ever seen GHCi complain\n"freeHaskellFunctionPtr: not for me, guv!" then is one is for you.'),(0,r.yg)("p",null,"Sylvain: Fixed a bug in\n",(0,r.yg)("a",{parentName:"p",href:"https://github.com/rrnewton/haskell-lockfree/pull/91"},"atomic-primops")," that was\ncausing GHC-9.10 to hang."),(0,r.yg)("p",null,"Sylvain: Fixed a fairly long-standing bug in GHC that caused a build with DWARF\nsymbols and no tables-next-to-code to no longer build. This was noticed by Jeff\nwhile writing the ",(0,r.yg)("a",{parentName:"p",href:"https://haskell.foundation/hs-opt-handbook.github.io/src/Measurement_Observation/Binary_Profiling/linux_perf.html#perf-chapter"},"perf\nchapter"),"\nof the haskell optimization handbook. ",(0,r.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/issues/22792"},"GHC#22792")," ",(0,r.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12641"},"GHC!12641")),(0,r.yg)("p",null,"Sylvain: Resurrected Ben's former MR that issues deprecation warnings for\nprimops. Previously, haddock in ",(0,r.yg)("inlineCode",{parentName:"p"},"ghc-prim")," would show these deprecation warnings but GHC wouldn't warn at their use sites. This\nis now fixed; so now a warning will be issued to the user if they use a deprecated primop. ",(0,r.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/issues/19629"},"GHC#19629")," ",(0,r.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/5548"},"GHC!5548"),".\nSo uses of deprecated primops in boot libraries have been fixed in the process (e.g. ",(0,r.yg)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/packages/array/-/merge_requests/28"},"array!28"),")."),(0,r.yg)("p",null,"Luite: Was on vacation getting lost in the mountains of Switzerland."))}h.isMDXComponent=!0}}]);