"use strict";(self.webpackChunkengineering_iog_io=self.webpackChunkengineering_iog_io||[]).push([[9946],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),h=p(n),m=r,d=h["".concat(s,".").concat(m)]||h[m]||c[m]||i;return n?a.createElement(d,o(o({ref:t},u),{},{components:n})):a.createElement(d,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},1955:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},assets:function(){return u},toc:function(){return c},default:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],l={slug:"2023-08-24-ghc-update",title:"IOG GHC Update #16",authors:["sylvain","doyougnu","luite","josh","bartek"],tags:["ghc","ghc-update"]},s=void 0,p={permalink:"/2023-08-24-ghc-update",editUrl:"https://github.com/input-output-hk/engineering/tree/master/blog/2023-08-24-ghc-update-16.md",source:"@site/blog/2023-08-24-ghc-update-16.md",title:"IOG GHC Update #16",description:"Triweekly update from the GHC DevX team at IOG.",date:"2023-08-24T00:00:00.000Z",formattedDate:"August 24, 2023",tags:[{label:"ghc",permalink:"/tags/ghc"},{label:"ghc-update",permalink:"/tags/ghc-update"}],readingTime:1.795,truncated:!0,authors:[{name:"Sylvain Henry",title:"Haskell DevX Engineer @ IOG",email:"sylvain.henry@iohk.io",key:"sylvain"},{name:"Jeffrey M. Young",title:"Haskell DevX Engineer @ IOG",url:"https://iog.io/en/",key:"doyougnu"},{name:"Luite Stegeman",title:"Haskell DevX Engineer @ IOG",email:"luite.stegeman@iohk.io",key:"luite"},{name:"Joshua Meredith",title:"Haskell DevX Engineer @ IOG",url:"https://iog.io/en/",key:"josh"},{name:"Bart\u0142omiej Cie\u015blar",title:"Haskell DevX Intern @ IOG",email:"bartlomiej.cieslar@iohk.io",key:"bartek"}],frontMatter:{slug:"2023-08-24-ghc-update",title:"IOG GHC Update #16",authors:["sylvain","doyougnu","luite","josh","bartek"],tags:["ghc","ghc-update"]},nextItem:{title:"IOG GHC Update #15",permalink:"/2023-08-03-ghc-update"}},u={authorsImageUrls:[void 0,void 0,void 0,void 0,void 0]},c=[{value:"CI / Testsuite",id:"ci--testsuite",children:[],level:2},{value:"Performance",id:"performance",children:[],level:2},{value:"JS Backend",id:"js-backend",children:[],level:2},{value:"Miscellaneous",id:"miscellaneous",children:[],level:2}],h={toc:c};function m(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Triweekly update from the GHC DevX team at IOG."),(0,i.kt)("p",null,"Previous updates can be found ",(0,i.kt)("a",{parentName:"p",href:"https://engineering.iog.io/tags/ghc-update"},"here"),"."),(0,i.kt)("h2",{id:"ci--testsuite"},"CI / Testsuite"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Sylvain: implemented ",(0,i.kt)("inlineCode",{parentName:"li"},"openat")," in JavaScript. See\n",(0,i.kt)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/issues/23697"},"GHC#23697")," and\n",(0,i.kt)("a",{parentName:"li",href:"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/10909"},"GHC!10909"),".\nFound while working on ",(0,i.kt)("inlineCode",{parentName:"li"},"unix"),"'s package testsuite (see\n",(0,i.kt)("a",{parentName:"li",href:"https://github.com/haskell/unix/pull/285"},"Unix!285"),".")),(0,i.kt)("h2",{id:"performance"},"Performance"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Josh: investigated alternative implementations of the union function for GHC's\nUDFM type, with the intent of removing the use of ",(0,i.kt)("inlineCode",{parentName:"p"},"Data.List.sort"),". For unknown\nreasons, there were mixed results in GHC's performance tests.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Josh: investigated the performance of package database loading in GHC. In comparing\nticky profiles of simple builds with and without package databases (see ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/haskell/cabal/issues/4093"},"https://github.com/haskell/cabal/issues/4093"),"),\nthere was a large amount of excess entries into ",(0,i.kt)("inlineCode",{parentName:"p"},"Word64Map.insert")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"List.++"),".\nMore investigation is required to find the source of these entries.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Luite: Investigated memory consumption of GHC when linking large JavaScript results.\nGHC consumes over 10GB of memory when linking various test cases in the testsuite that\ncompile the GHC API to JavaScript. Investigation is still ongoing,\nsee ",(0,i.kt)("a",{parentName:"p",href:"https://gitlab.haskell.org/ghc/ghc/-/issues/23882"},"GHC#23882"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Jeff: Finished investigating a performance regression in cardano-ledger when migrating from GHC-8.10.7 to GHC-9.2.8 and the report. This work will be rolled into a chapter for the ",(0,i.kt)("a",{parentName:"p",href:"https://haskell.foundation/hs-opt-handbook.github.io/"},"Optimization Handbook"),"."))),(0,i.kt)("h2",{id:"js-backend"},"JS Backend"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Josh: Built the GHCJS libraries against the first GHC 9.8 alpha release. There\nare many version bumps required in ",(0,i.kt)("inlineCode",{parentName:"p"},"ghcjs-base")," dependencies, due to boot library\nchanges, but not many code changes. Because of various JS backend fixes in GHC\n9.8, these library updates will delay the release of the GHCJS libraries for the\nJS backend.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Luite: The ",(0,i.kt)("inlineCode",{parentName:"p"},"process")," submodule has been bumped to include support for the JavaScript\nbackend and to fix a bug on macOS. This also enables JavaScript CI tests for the\n",(0,i.kt)("inlineCode",{parentName:"p"},"process")," package. From now on ",(0,i.kt)("inlineCode",{parentName:"p"},"process")," can be used for the JavaScript\ntarget, for example to build node.js scripts that manage other processes or packages\nthat use the Cabal custom setup method."))),(0,i.kt)("h2",{id:"miscellaneous"},"Miscellaneous"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Jeff: Finished his ",(0,i.kt)("a",{parentName:"p",href:"https://icfp23.sigplan.org/home/funarch-2023#"},"presentation")," for FUNARCH 2023. See you at ICFP!")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Bartek: Finished his internship with us and has moved on to his next year of study. We enjoyed his stay, wish him the best of luck, and appreciate his labor."))))}m.isMDXComponent=!0}}]);