---
slug: 2024-07-24-ghc-update
title: "IOG GHC Update #32"
authors: [sylvain,doyougnu,luite]
tags: [ghc,ghc-update]
---

Triweekly update from the GHC DevX team at IOG.

<!-- truncate -->

Previous updates can be found [here](https://engineering.iog.io/tags/ghc-update).

## High-level Summary


## Details

Sylvain: fixed RTS linker on AArch64 to use the M32 allocator to avoid an excessive amount of calls to `mmap` and fragmentation. See [GHC#24432](https://gitlab.haskell.org/ghc/ghc/-/issues/24432) and [GHC!12914](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/12914). This was done in the process to update patches from haskell.nix to GHC upstream. This patch however is different from its haskell.nix counterpart which introduces a new allocator memory pool based allocator with different tradeoffs.

Sylvain: helped with debugging of performance issue in [GHC#25055](https://gitlab.haskell.org/ghc/ghc/-/issues/25055), which was fixed by Simon PJ in [GHC!13038](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/13038).
In the process I've found another unrelated bug [GHC#25096](https://gitlab.haskell.org/ghc/ghc/-/issues/25096) being fixed by Simon in [GHC!13060](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/13060). Sadly the former bug doesn't explain the cardano node performance regression we were ivnestigating a few weeks ago. We'll check if the second one explains it when it will be fixed.
