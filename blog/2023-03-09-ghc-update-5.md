---
slug: 2023-03-09-ghc-update
title: "IOG GHC Update #5"
authors: [sylvain,doyougnu,luite,josh]
tags: [ghc,ghc-update]
---

Biweekly update from the GHC DevX team at IOG.

Previous updates can be found [here](https://engineering.iog.io/tags/ghc-update).

## JavaScript backend

### Template Haskell

Sylvain: [!9779](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/9779)
has been merged (CHECK)

Luite: [!10008](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/10008)
Implemented keeping track of subdirectories in GHC's temporary file manager.
has been merged (CHECK).

### JavaScript EDSL

Jeff: MR is [open](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/10000).
In response to feedback from the team Jeff has added (and removed)
several features that distinguish the eDSL from
[sunroof](https://github.com/ku-fpg/sunroof-compiler). These include: removing
threading and continuations, adding named unique variables and a proper switch
statement. These changes allow more of the RTS to be replaced in the eDSL and
allow the RTS to be typed using Haskell's type system. For example, now the STG
registers track the type of the values they hold.

### copyMutableArray primops

Sylvain: fixed JS implementations for `copyMutableByteArray#` and
`copySmallMutableArray` primops. They were wrong in some cases when the source
and target arrays overlap. See
[#23033](https://gitlab.haskell.org/ghc/ghc/-/issues/23033) and
[!10037](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/10037).

### Testsuite

Sylvain: made a minor cleanup in the testsuite to correctly tag tests requiring
Cmm support (which the JS backend doesn't have):
[!10043](https://gitlab.haskell.org/ghc/ghc/-/merge_requests/10043).

----


## Compiler performance

### Optimization Handbook

Jeff: ?

----

## GHCi

Luite: ?
